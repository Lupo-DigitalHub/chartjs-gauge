/*!
 * chartjs-gauge-v3 v3.0.0
 * https://uk-taniyama.github.io/chartjs-gauge/
 * (c) 2023 chartjs-gauge-v3 Contributors
 * Released under the MIT License
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("chart.js"),require("chart.js/helpers")):"function"==typeof define&&define.amd?define(["exports","chart.js","chart.js/helpers"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ChartGauge={},e.Chart,e.Chart.helpers)}(this,(function(e,t,r){"use strict";const s={needle:{radius:"10%",width:"15%",length:"80%"},valueLabel:{display:!0,font:void 0,formatter:Math.round,color:()=>"#FFF",backgroundColor:t.Chart.defaults.backgroundColor,borderColor:t.Chart.defaults.borderColor,borderWidth:0,borderRadius:5,padding:{top:5,right:5,bottom:5,left:5},offsetX:0,offsetY:0},animation:{animateRotate:!0,animateScale:!1},cutout:"50%",rotation:-90,circumference:180,value:0,minValue:0};class i extends t.DoughnutController{constructor(e,r){super(e,r),this.center=new t.ArcElement({}),this.values=[],this.valuePercent=0,this.previous=0,this.current=0}_updateMeta(){const e=this._cachedMeta,t=e._parsed;if(this.values=[],this.valuePercent=0,0===t.length)return e;const r=this.options,{value:s=0,minValue:i=0}=r,o=t.length>0?t[t.length-1]:i+1;t.reduce(((e,t)=>(this.values.push(t-e),t)),i);const a=o-i;return this.valuePercent=s/a,e}_getTranslation(){const e=this._cachedMeta.data[0];return null==e?{dx:0,dy:0}:{dx:e.x,dy:e.y}}_getAngle(e){const t=this.options,{rotation:s,circumference:i}=t;return r.toRadians(s+i*e)}_getSize(e){return r.toPercentage(e,this.outerRadius)*this.outerRadius}drawNeedle(){const e=this.options,{ctx:t}=this.chart,{needle:r}=e,{radius:s,width:i,length:o}=r,{color:a}=r,n=this._getSize(s),l=this._getSize(i),d=this._getSize(o),{dx:u,dy:h}=this._getTranslation(),c=this._getAngle(this.center.endAngle);t.save(),t.translate(u,h),t.rotate(c),t.fillStyle=a,t.beginPath(),t.ellipse(0,0,n,n,0,0,2*Math.PI),t.fill(),t.beginPath(),t.moveTo(-l/2,0),t.lineTo(-l/2,-d),t.arcTo(0,2-d,l,-d,50),t.lineTo(l/2,0),t.fill(),t.restore()}drawValueLabel(){const e=this.options,{valueLabel:t}=e;if(!t.display)return;const{ctx:s}=this.chart,{color:i,formatter:o,backgroundColor:a,borderColor:n,borderWidth:l,borderRadius:d,padding:u,offsetX:h,offsetY:c}=t,p=r.toFont(t.font),{value:g}=e,f=(o?o(g):g).toString();s.save(),s.textBaseline="middle",s.textAlign="center",s.font=p.string;const{width:v}=s.measureText(f),{lineHeight:b}=p,_=1*b,m=-(u.left+v/2)-l,x=-(u.top+_/2)-l,y=u.left+v+u.right+2*l,C=u.top+_+u.bottom+2*l;let{dx:P,dy:R}=this._getTranslation();P+=this._getSize(h),R+=this._getSize(c),s.translate(P,R),s.fillStyle=a,s.beginPath(),r.addRoundedRectPath(s,{x:m,y:x,w:y,h:C,radius:r.toTRBLCorners(d)}),s.closePath(),s.fill(),l&&(s.strokeStyle=n,s.lineWidth=l,s.stroke());r.renderText(s,f,0,.075*_,p,{textAlign:"center",textBaseline:"middle",color:i}),s.restore()}update(e){const t="reset"===e,r=this._updateMeta();t?(this.previous=0,this.current=0):(this.previous=this.current||0,this.current=this.valuePercent);const s=r._parsed;r._parsed=this.values,super.update(e),r._parsed=s}updateElements(e,t,r,s){const i=this._cachedMeta,o=i._parsed;if(i._parsed=this.values,super.updateElements(e,t,r,s),i._parsed=o,0===e.length)return;const a=e[0];super.updateElement(this.center,void 0,{x:a.x,y:a.y,startAngle:this.previous,endAngle:this.current,circumference:0,outerRadius:100,innerRadius:0,options:{}},s)}draw(){super.draw(),0!==this.values.length&&(this.drawNeedle(),this.drawValueLabel())}}i.id="gauge",i.version="3.0.0",i.defaults=s,i.descriptors={_scriptable:e=>"formatter"!==e},i.overrides={aspectRatio:!1,layout:{padding:{top:10,bottom:80}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},t.Chart.register(i),t.Chart.register(t.ArcElement),e.GaugeController=i,Object.defineProperty(e,"__esModule",{value:!0})}));
